<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<!-- bootstrap -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<!-- prims plugin styles -->
<Link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/autolinker/prism-autolinker.min.css" rel="stylesheet">
<Link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/command-line/prism-command-line.min.css" rel="stylesheet">
<Link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">
<Link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet">
<!-- ajax -->
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism-tomorrow.min.css'>

<title>video trackbar slider</title>
<style>
a,
a:hover,
a:focus {
	text-decoration: none;
}

.pager .top {
	float: center;
}

.dark-mode {
	background-color: black;
	color: #aaaaaa;
}

.dark-mode a {
	color: darkblue;
}

.dark-mode .page-link {
	color: #bdc0c4;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .page-link .disabled li > a {
	color: #bdc0c4;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .pager li > a,
.dark-mode .pager li > span {
	color: #bdc0c4;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .pager li > a:hover,
.dark-mode .pager li > a:focus,
.dark-mode .pager li > span:hover {
	background-color: #555555;
	color: #bdc0c4;
}

.dark-mode .pager .disabled a,
.dark-mode .pager .disabled a:hover,
.dark-mode .pager .disabled a:focus {
	color: #6c757d;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .breadcrumb {
	background-color: #212529;
}

.dark-mode .breadcrumb a {
	color: #bdc0c4;
}

.dark-mode .breadcrumb a:hover,
.dark-mode .breadcrumb a:focus {
	text-decoration: none;
	color: #777777;
}

.breadcrumb a,
.breadcrumb a:hover,
.breadcrumb a:focus {
	text-decoration: none;
}

/* prism overrides */
div.code-toolbar>.toolbar a,
div.code-toolbar>.toolbar button,
div.code-toolbar>.toolbar span {
	margin-left: 0.7rem;
}

pre {
	margin-bottom: 1.3rem !important;
}

.breadcrumb-item+.breadcrumb-item::before {
	content: '> ';
}

</style>
</head>
<body class="container">
<div class="container" >
<ol class="breadcrumb">
<li class="breadcrumb-item"><a href="4.0.html">C++</a></li>
<li class="breadcrumb-item"><a href="4.3.0.html">Image Processing</a></li>
<li class="breadcrumb-item"><a href="4.3.2.0.html">Fundamentals</a></li>
<li class="breadcrumb-item"><a href="4.3.2.2.0.html">Tools</a></li>
<li class="breadcrumb-item active" >video trackbar slider</li>
</ol>
<h2>video trackbar slider</h2>
<div class="comment-style" >
   To add a **trackbar slider** to the video player we have made previously,<br />
   a few more lines should be written.<br />
   <br />
   First, to make this slider work on our player, it should have access to the
   **video capture object** of type **cv::VideoCapture**, here called *g_video_cap*.<br />
   So, we set *video* object globally accessible in our program.<br />
   Besides, we need a global slider position variable so that we know where the slider is
   set anywhere in our program.<br />
   <br />
   Trackbar slider requires a function callback in order to move between frames
   with it. Here we call it **move_slider** function.<br />
   This function gets destination frame position as its first argument, and a
   null pointer as its second argument.<br />
   Then it uses **set** method of *g_video_cap* to move the slider position.<br />
   This method takes an opencv constant **cv::PROP_CAP_POS_FRAMES** which indicates
   the position of current frame where the slider is set on.<br />
   Then it takes the *position* of new frame
   as its second argument to move the slider to it.<br />
   <br />
   To move slider around, we need to have some information about how many frames does the video is contained of.<br />
   So we use opencv constants to get these kind of information by using **get** method in video object right after
   we opened the file.<br />
   <br />
   Now, we open the video file and create a new window and resize it to the size of our interest.<br />
   Then we create the taskbar slider by using **cv::createTaskbar** function which takes slider position name
   as its first argument, the window name which the video will be played on as its second argument, the global
   slider position variable as its third argument, number of total frames that video is contained of as fourth
   argument, and finally **move_slider** callback function as its fifth argument to let the taskbar move slider.<br />
   <br />
   Finally we create a loop to show video frames one by one until we run out of video frames.<br />
   Between this loop, we need to move the slider one frame before the player actually shows next frame in window.<br />
   We do that by **cv::setTrackPos()** function which takes the position name, window name and slider position as
   its three arguments respectively.<br />
</div>
<hr />
<h3>Source</h3>
  <cite>trackbar.cxx</cite>
<pre class="line-numbers" >
<code class="language-cpp">
    #include &lt;opencv2/highgui/highgui.hpp&gt;
    #include &lt;opencv2/imgproc/imgproc.hpp&gt;
    #include &lt;iostream&gt;
    #include &lt;fstream&gt;
    
    int g_slider_position = 0;
    cv::VideoCapture g_video_cap;
    
    void move_slider(int position, void*) {
        g_video_cap.set(cv::CAP_PROP_POS_FRAMES, position);
    }
    
    int main()
    {
        g_video_cap.open(&quot;sample.mp4&quot;);
    
        int total_frames = (int)g_video_cap.get(cv::CAP_PROP_FRAME_COUNT);
        int frame_width = (int)g_video_cap.get(cv::CAP_PROP_FRAME_WIDTH);
        int frame_height = (int)g_video_cap.get(cv::CAP_PROP_FRAME_HEIGHT);
        std::cout &lt;&lt; &quot;reading &quot; &lt;&lt; total_frames &lt;&lt; &quot; frames in &quot; \
            &lt;&lt; frame_height &lt;&lt; &quot;x&quot; &lt;&lt; frame_width &lt;&lt; std::endl;
    
        cv::namedWindow(&quot;video player&quot;, cv::WINDOW_NORMAL);
        cv::resizeWindow(&quot;video player&quot;, 720, 480);
        cv::createTrackbar(&quot;position&quot;, &quot;video player&quot;, &amp;g_slider_position, total_frames, move_slider);
    
        cv::Mat frame;
        while (true) {
            g_video_cap &gt;&gt; frame;
            if (frame.empty()) {
                std::cerr &lt;&lt; &quot;ran out of frames&quot; &lt;&lt; std::endl;
                break;
            }
    
            int current_position = g_video_cap.get(cv::CAP_PROP_POS_FRAMES);
            cv::setTrackbarPos(&quot;position&quot;, &quot;video player&quot;, current_position);
            cv::imshow(&quot;video player&quot;, frame);
    
            if (cv::waitKey(10) == 27) {
                std::cerr &lt;&lt; &quot;user interrupted&quot; &lt;&lt; std::endl;
                break;
            }
        }
    
        cv::destroyWindow(&quot;video player&quot;);
        return 0;
    }
</code>
</pre>
<ul class="pager">
<li class="previous"><a href="4.3.2.2.2.html">previous page</a></li>
<li class="top"><a href="index.html">top page</a></li>
<li class="next"><a href="4.3.2.3.0.html">next page</a></li>
</ul>
</div>
<script>
function darkmode(manual) {
	const hours = new Date().getHours();
	const isNight = !(hours > 6 && hours < 20);
	var bodystyle = document.body;
	if (isNight || manual) {
		bodystyle.classList.add("dark-mode");
	} else {
		bodystyle.classList.remove("dark-mode");
	}
}
darkmode();
</script>
<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<!-- bootstrap -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
<!-- prism js -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/prism.min.js'></script>
<!-- prism languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-c.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-clike.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-asm6502.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-cpp.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-bash.min.js"></script>
<!-- prism plugins -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/toolbar/prism-toolbar.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/autolinker/prism-autolinker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/command-line/prism-command-line.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/remove-initial-line-feed/prism-remove-initial-line-feed.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/show-language/prism-show-language.min.js"></script>
</body>
</html>
