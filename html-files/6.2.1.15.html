<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<!-- bootstrap -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<!-- prims plugin styles -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/autolinker/prism-autolinker.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/command-line/prism-command-line.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet">
<!-- ajax -->
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism-tomorrow.min.css'>

<title>move constructor</title>
<style>
a,
a:hover,
a:focus {
	text-decoration: none;
}

.pager .top {
	float: center;
}

.dark-mode {
	background-color: black;
	color: #aaaaaa;
}

.dark-mode a {
	color: royalblue;
}

.dark-mode .page-link {
	color: #bdc0c4;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .page-link .disabled li > a {
	color: #bdc0c4;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .pager li > a,
.dark-mode .pager li > span {
	color: #bdc0c4;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .pager li > a:hover,
.dark-mode .pager li > a:focus,
.dark-mode .pager li > span:hover {
	background-color: #555555;
	color: #bdc0c4;
}

.dark-mode .pager .disabled a,
.dark-mode .pager .disabled a:hover,
.dark-mode .pager .disabled a:focus {
	color: #6c757d;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .breadcrumb {
	background-color: #212529;
}

.dark-mode .breadcrumb a {
	color: #bdc0c4;
}

.dark-mode .breadcrumb a:hover,
.dark-mode .breadcrumb a:focus {
	text-decoration: none;
	color: #777777;
}

.breadcrumb a,
.breadcrumb a:hover,
.breadcrumb a:focus {
	text-decoration: none;
}

/* prism overrides */
div.code-toolbar>.toolbar a,
div.code-toolbar>.toolbar button,
div.code-toolbar>.toolbar span {
	margin-left: 0.7rem;
}

pre {
	margin-bottom: 1.3rem !important;
}

.breadcrumb-item+.breadcrumb-item::before {
	content: '> ';
}

</style>
</head>
<body class="container">
<ol class="breadcrumb">
<li class="breadcrumb-item"><a href="/">Home</a></li>
<li class="breadcrumb-item"><a href="/6.0.html">C++</a></li>
<li class="breadcrumb-item"><a href="/6.2.0.html">Object Orientation</a></li>
<li class="breadcrumb-item"><a href="/6.2.1.0.html">Classes and Objects</a></li>
<li class="breadcrumb-item active" >move constructor</li>
</ol>
<h2>move constructor</h2>
<div class="comment-style" >
   Move semantics are helpful when there's a big object which we cannot afford having another copy of it.<br />
   In this situation when there's not enough memory to just have a few copies of an object, we need to directly move those objects when they are passed as arguments or they are returned from functions.<br />
   <br />
   To make **move semantics** happen, we need to declare a **move constructor**, the way we declared a copy constructor. Instead, here we have two & operators meaning the move operator.<br />
   and there's another difference between move constructor and a copy constructor, and that's we set the source members to NULL after we moved them to the destination. This way, source will no longer exist, and the object is moved to the destination. No extra memory occupied.<br />
   To make sure object is moved we also use **std::move()** function.<br />
</div>
<hr />
<h3>Source</h3>
  <cite>move_constructor.cxx</cite>
<pre class="line-numbers" >
<code class="language-cpp">
    #include &lt;iostream&gt;
    #include &lt;cstring&gt;
    
    class Base {
    public:
        Base(const char* input) {
            std::cout &lt;&lt; &quot;Constructor Invoked&quot; &lt;&lt; std::endl;
            member = nullptr;
    
            if (input != nullptr) {
                member = new char[strlen(input)+1];
                strcpy(member, input);
                std::cout &lt;&lt; &quot;member address: &quot; &lt;&lt; std::hex &lt;&lt; &amp;member &lt;&lt; std::endl;
            }
        };
    
        Base(const Base&amp; base) {
            std::cout &lt;&lt; &quot;Copy Constructor Invoked&quot; &lt;&lt; std::endl;
            member = nullptr;
    
            if (base.member != nullptr) {
                member = new char[strlen(base.member)+1];
                strcpy(member, base.member);
                std::cout &lt;&lt; &quot;copied member address: &quot; &lt;&lt; std::hex &lt;&lt; &amp;member &lt;&lt; std::endl;
            }
        };
    
        Base(const Base&amp;&amp; base) {
            std::cout &lt;&lt; &quot;Move Constructor Invoked&quot; &lt;&lt; std::endl;
            member = nullptr;
    
            if (base.member != nullptr) {
                member = new char[strlen(base.member)+1];
                strcpy(member, base.member);
                std::cout &lt;&lt; &quot;movable member address: &quot; &lt;&lt; std::hex &lt;&lt; &amp;base.member &lt;&lt; std::endl;
                std::cout &lt;&lt; &quot;moved member address: &quot; &lt;&lt; std::hex &lt;&lt; &amp;member &lt;&lt; std::endl;
                delete [] base.member;
            }
        };
    
        ~Base() {
            std::cout &lt;&lt; &quot;Destructor Invoked&quot; &lt;&lt; std::endl;
            if (member != nullptr) {
                delete [] member;
            }
        };
    
    private:
        char* member;
    };
    
    Base&amp;&amp; move(Base&amp; base) {
        return std::move(base);
    }
    
    int main()
    {
        Base object(&quot;using move semantics&quot;);
        Base reference = move(object);
    
        return 0;
    }
</code>
</pre>
<h3>Execution</h3>
<h4>compile</h4>
<pre class="command-line" data-user="cpp" data-host="milestone">
<code class="language-bash">
g++ -g -Wall -Os -c -o move_constructor.o move_constructor.cxx
</code>
</pre>
<h4>link</h4>
<pre class="command-line" data-user="cpp" data-host="milestone">
<code class="language-bash">
g++ -o move_constructor.bin move_constructor.o
</code>
</pre>
<h4>run</h4>
<pre class="command-line" data-user="cpp" data-host="milestone">
<code class="language-bash">
./move_constructor.bin
</code>
</pre>
<h3>Output</h3>
<pre class="language-bash" begin language-bash>
<code>
Constructor Invoked
member address: 0x7ffc16d74388
Move Constructor Invoked
movable member address: 0x7ffc16d74388
moved member address: 0x7ffc16d74390
Destructor Invoked
Destructor Invoked
</code>
</pre>
<ul class="pager">
<li class="previous"><a href="/6.2.1.14.html">previous page</a></li>
<li class="top"><a href="/">top page</a></li>
<li class="next"><a href="/6.2.1.16.html">next page</a></li>
</ul>
<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<!-- bootstrap -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
<!-- prism js -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/prism.min.js'></script>
<!-- prism languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-c.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-cpp.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-bash.min.js"></script>
<!-- prism plugins -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/toolbar/prism-toolbar.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/autolinker/prism-autolinker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/command-line/prism-command-line.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/remove-initial-line-feed/prism-remove-initial-line-feed.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/show-language/prism-show-language.min.js"></script>
<script>
$(function() {
  $('.list-group-item').on('click', function() {
    $('.glyphicon', this)
      .toggleClass('glyphicon-chevron-right')
      .toggleClass('glyphicon-chevron-down');
  });
});
</script>
<script>
function darkmode(manual) {
	const hours = new Date().getHours();
	const isNight = !(hours > 6 && hours < 20);
	var bodystyle = document.body;
	if (isNight || manual) {
		bodystyle.classList.add("dark-mode");
	} else {
		bodystyle.classList.remove("dark-mode");
	}
}
darkmode();
</script>
</body>
</html>
