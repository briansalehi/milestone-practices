<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<!-- bootstrap -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<!-- prims plugin styles -->
<Link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/autolinker/prism-autolinker.min.css" rel="stylesheet">
<Link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/command-line/prism-command-line.min.css" rel="stylesheet">
<Link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">
<Link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet">
<!-- ajax -->
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism-tomorrow.min.css'>

<title>Detach Threads</title>
<style>
a,
a:hover,
a:focus {
	text-decoration: none;
}

.pager .top {
	float: center;
}

.dark-mode {
	background-color: black;
	color: #aaaaaa;
}

.dark-mode a {
	color: darkblue;
}

.dark-mode .page-link {
	color: #bdc0c4;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .page-link .disabled li > a {
	color: #bdc0c4;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .pager li > a,
.dark-mode .pager li > span {
	color: #bdc0c4;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .pager li > a:hover,
.dark-mode .pager li > a:focus,
.dark-mode .pager li > span:hover {
	background-color: #555555;
	color: #bdc0c4;
}

.dark-mode .pager .disabled a,
.dark-mode .pager .disabled a:hover,
.dark-mode .pager .disabled a:focus {
	color: #6c757d;
	background-color: #212529;
	border: 1px solid #616161;
}

.dark-mode .breadcrumb {
	background-color: #212529;
}

.dark-mode .breadcrumb a {
	color: #bdc0c4;
}

.dark-mode .breadcrumb a:hover,
.dark-mode .breadcrumb a:focus {
	text-decoration: none;
	color: #777777;
}

.breadcrumb a,
.breadcrumb a:hover,
.breadcrumb a:focus {
	text-decoration: none;
}

/* prism overrides */
div.code-toolbar>.toolbar a,
div.code-toolbar>.toolbar button,
div.code-toolbar>.toolbar span {
	margin-left: 0.7rem;
}

pre {
	margin-bottom: 1.3rem !important;
}

.breadcrumb-item+.breadcrumb-item::before {
	content: '> ';
}

</style>
</head>
<body class="container">
<div class="container" >
<ol class="breadcrumb">
<li class="breadcrumb-item"><a href="/6.0.html">C++</a></li>
<li class="breadcrumb-item"><a href="/6.2.0.html">Multithreading</a></li>
<li class="breadcrumb-item"><a href="/6.2.1.0.html">Threads</a></li>
<li class="breadcrumb-item active" >Detach Threads</li>
</ol>
<h2>Detach Threads</h2>
<div class="comment-style" >
   Threads can be detached from the main thread, meaning they will keep running even after the calling thread exits.<br />
   Should this program give any output? no! threads are detached from the main thread and they will no longer have access to the standard output of the running terminal, but they will write those strings in some buffer somewhere. The thing is they do their job detached.<br />
</div>
<hr />
<h3>Source</h3>
  <cite>detach.cxx</cite>
<pre class="line-numbers" >
<code class="language-cpp">
    #include &lt;iostream&gt;
    #include &lt;chrono&gt;
    #include &lt;thread&gt;
    #include &lt;mutex&gt;
    
    std::mutex cout_mtx;
    
    void worker() {
        std::thread::id thread_id = std::this_thread::get_id();
    
        cout_mtx.lock();
        std::cout &lt;&lt; &quot;thread &quot; &lt;&lt; thread_id &lt;&lt; &quot; sleep cycle 1&quot; &lt;&lt; std::endl;
        cout_mtx.unlock();
        std::this_thread::sleep_for(std::chrono::seconds(1));
    
        cout_mtx.lock();
        std::cout &lt;&lt; &quot;thread &quot; &lt;&lt; thread_id &lt;&lt; &quot; sleep cycle 2&quot; &lt;&lt; std::endl;
        cout_mtx.unlock();
        std::this_thread::sleep_for(std::chrono::seconds(1));
    }
    
    int main()
    {
        std::thread t1(worker);
        std::thread t2(worker);
    
        t1.detach();
        t2.detach();
        return 0;
    }
</code>
</pre>
<h3>Execution</h3>
<h4>compile</h4>
<pre class="command-line" data-user="cpp" data-host="milestone">
<code class="language-bash">
g++ -g -Wall -Os -c -o detach.o detach.cxx
</code>
</pre>
<h4>link</h4>
<pre class="command-line" data-user="cpp" data-host="milestone">
<code class="language-bash">
g++ -Wall -g -lpthread -o detach.bin detach.o
</code>
</pre>
<h4>run</h4>
<pre class="command-line" data-user="cpp" data-host="milestone">
<code class="language-bash">
./detach.bin
</code>
</pre>
<h3>Output</h3>
<pre class="language-bash" begin language-bash>
<code>
thread 139810392323648 sleep cycle 1
</code>
</pre>
<ul class="pager">
<li class="previous"><a href="/6.2.1.7.html">previous page</a></li>
<li class="top"><a href="/index.html">top page</a></li>
<li class="next"><a href="/6.2.2.0.html">next page</a></li>
</ul>
</div>
<script>
function darkmode(manual) {
	const hours = new Date().getHours();
	const isNight = !(hours > 6 && hours < 20);
	var bodystyle = document.body;
	if (isNight || manual) {
		bodystyle.classList.add("dark-mode");
	} else {
		bodystyle.classList.remove("dark-mode");
	}
}
darkmode();
</script>
<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<!-- bootstrap -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
<!-- prism js -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/prism.min.js'></script>
<!-- prism languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-c.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-cpp.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-bash.min.js"></script>
<!-- prism plugins -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/toolbar/prism-toolbar.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/autolinker/prism-autolinker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/command-line/prism-command-line.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/remove-initial-line-feed/prism-remove-initial-line-feed.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/show-language/prism-show-language.min.js"></script>
</body>
</html>
